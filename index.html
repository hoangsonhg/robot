<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robot CND - Gemini 3.0 Final</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; text-align: center; background: #010409; color: #e6edf3; padding: 20px; margin: 0; }
        .container { max-width: 500px; margin: auto; padding: 30px; background: #0d1117; border-radius: 40px; border: 2px solid #30363d; box-shadow: 0 30px 60px rgba(0,0,0,0.8); }
        .ai-pulse { width: 160px; height: 160px; border-radius: 50%; background: #161b22; margin: 25px auto; display: flex; align-items: center; justify-content: center; border: 8px solid #30363d; transition: 0.3s; font-size: 60px; }
        .listening { border-color: #238636; box-shadow: 0 0 40px #238636; animation: breath 1s infinite; }
        .speaking { border-color: #1f6feb; box-shadow: 0 0 40px #1f6feb; }
        @keyframes breath { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        #startBtn { padding: 20px 40px; border-radius: 50px; border: none; background: #238636; color: white; font-weight: bold; cursor: pointer; font-size: 22px; }
        #chatLog { margin-top: 30px; background: rgba(0,0,0,0.5); height: 180px; overflow-y: auto; border-radius: 20px; padding: 20px; text-align: left; font-size: 15px; border: 1px solid #30363d; }
    </style>
</head>
<body>
    <div class="container">
        <h2 style="color: #58a6ff;">ü§ñ L·ªÑ T√ÇN CND - GEMINI 3.0</h2>
        <div id="visual" class="ai-pulse">üéôÔ∏è</div>
        <p id="info" style="color: #8b949e;">B·∫•m n√∫t ƒë·ªÉ em tr·ª±c qu·∫ßy cho anh!</p>
        <button id="startBtn">K√çCH HO·∫†T ROBOT</button>
        <div id="chatLog"></div>
    </div>

    <script>
        // API KEY V√Ä MODEL 3.0
        const API_KEY = "AIzaSyCs8gITrFcSUHYe_6KeJnWrcQd0tBdMgwo";
        const MODEL = "gemini-3.0-flash"; 

        // TH·ª∞C ƒê∆†N ƒê·∫¶Y ƒê·ª¶ NH√Ä H√ÄNG CND
        const SYSTEM_PROMPT = `B·∫°n l√† nh√¢n vi√™n l·ªÖ t√¢n 18 tu·ªïi t·∫°i Nh√† h√†ng CND ƒê·ªìng VƒÉn. 
        - Ch·ªß: Anh S∆°n (ƒê·∫ßu b·∫øp, Ph√≥ Ch·ªß t·ªãch H·ªôi Du l·ªãch ƒê·ªìng VƒÉn).
        - Th·ªãt Ng·ª±a: X√†o/N∆∞·ªõng (250k), Th·∫Øng c·ªë (350k).
        - Th·ªãt B√≤/D√™: B√≤ n∆∞·ªõng (250k), Th·∫Øng c·ªë d√™ (230k), Th·∫Øng c·ªë b√≤ (150k).
        - G√† ƒêen: Rang/N∆∞·ªõng (250k), Lu·ªôc (600k/con).
        - C√° T·∫ßm/LƒÉng: N∆∞·ªõng/X√†o (250k-300k).
        - L·∫©u (2-8 ng∆∞·ªùi): 600k - 1tr2. M·∫πt ƒë·∫∑c s·∫£n 6-8 ng∆∞·ªùi: 1 tri·ªáu/m·∫πt.
        - ƒê·ªì u·ªëng: Bia 25-30k, R∆∞·ª£u ng√¥ 40k.
        PHONG C√ÅCH: Nh√≠ nh·∫£nh, l·ªÖ ph√©p, tr·∫£ l·ªùi d∆∞·ªõi 12 t·ª´ (D·∫°/·∫†). Website: dulichcaonguyenda.com.`;

        const startBtn = document.getElementById('startBtn');
        const visual = document.getElementById('visual');
        const info = document.getElementById('info');
        const chatLog = document.getElementById('chatLog');

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recog = new SpeechRecognition();
        recog.lang = 'vi-VN';
        const synth = window.speechSynthesis;
        let active = false;

        const speak = (text) => {
            visual.className = "ai-pulse speaking";
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'vi-VN';
            utterance.pitch = 1.5; 
            utterance.onend = () => { if(active) recog.start(); };
            synth.speak(utterance);
        };

        startBtn.onclick = () => { active = true; startBtn.style.display = 'none'; recog.start(); };

        recog.onstart = () => { visual.className = "ai-pulse listening"; visual.innerText = "üü¢"; info.innerText = "Em ƒëang nghe ƒë√¢y ·∫°..."; };
        
        recog.onresult = async (event) => {
            const query = event.results[0][0].transcript;
            chatLog.innerHTML = `<div><b>Kh√°ch:</b> ${query}</div>` + chatLog.innerHTML;
            visual.innerText = "‚è≥";

            try {
                // G·ªåI API GEMINI 3.0 CHU·∫®N
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: SYSTEM_PROMPT + " Kh√°ch h·ªèi: " + query }] }] })
                });
                const data = await response.json();
                const reply = data.candidates[0].content.parts[0].text;
                chatLog.innerHTML = `<div style="color:#58a6ff"><b>Robot:</b> ${reply}</div>` + chatLog.innerHTML;
                speak(reply);
            } catch (e) {
                console.error(e);
                if(active) setTimeout(() => recog.start(), 500);
            }
        };

        recog.onend = () => { if(active && !synth.speaking) setTimeout(() => recog.start(), 300); };
    </script>
</body>
</html>
