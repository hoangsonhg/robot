<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robot CND - Gemini 3.0 Final</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; text-align: center; background: #020617; color: #f8fafc; padding: 20px; margin: 0; }
        .robot-box { max-width: 500px; margin: auto; padding: 30px; background: #0f172a; border-radius: 30px; border: 2px solid #1e293b; box-shadow: 0 25px 60px rgba(0,0,0,0.6); }
        .status-light { width: 120px; height: 120px; border-radius: 50%; background: #1e293b; margin: 25px auto; display: flex; align-items: center; justify-content: center; border: 6px solid #334155; font-size: 50px; transition: 0.3s; }
        .listening { border-color: #10b981; box-shadow: 0 0 40px #10b981; }
        .speaking { border-color: #3b82f6; box-shadow: 0 0 40px #3b82f6; }
        #startBtn { padding: 20px 40px; border-radius: 50px; border: none; background: #e11d48; color: white; font-weight: bold; cursor: pointer; font-size: 20px; margin-top: 10px; }
        #chatLog { margin-top: 30px; background: rgba(0,0,0,0.3); height: 180px; overflow-y: auto; border-radius: 15px; padding: 15px; text-align: left; font-size: 14px; border: 1px solid #1e293b; }
    </style>
</head>
<body>
    <div class="robot-box">
        <h2 style="color: #38bdf8;">ü§ñ L·ªÑ T√ÇN CND ƒê·ªíNG VƒÇN</h2>
        <div id="aiVisual" class="status-light">üéôÔ∏è</div>
        <p id="infoStatus">H·ªá th·ªëng ƒëang ch·ªù l·ªánh...</p>
        <button id="startBtn">K√çCH HO·∫†T ROBOT</button>
        <div id="chatLog"></div>
    </div>

    <script>
        // API KEY C·ª¶A ANH S∆†N
        const API_KEY = "AIzaSyCs8gITrFcSUHYe_6KeJnWrcQd0tBdMgwo";
        const MODEL = "gemini-3.0-flash"; // B·∫£n si√™u t·ªëc nƒÉm 2026
        
        // TO√ÄN B·ªò TH·ª∞C ƒê∆†N CHI TI·∫æT
        const CND_PROMPT = `
            B·∫°n l√† l·ªÖ t√¢n 18 tu·ªïi t·∫°i Nh√† h√†ng CND ƒê·ªìng VƒÉn. Ch·ªß l√† anh S∆°n (ƒê·∫°i bi·ªÉu HƒêND).
            D·ªÆ LI·ªÜU CND: 
            - L·∫©u (Ng·ª±a, B√≤, D√™, G√† ƒêen, Th·∫≠p c·∫©m): 600k (2-3 ng∆∞·ªùi), 1tr (4-6 ng∆∞·ªùi), 1.2tr (7-8 ng∆∞·ªùi).
            - M·∫πt ƒë·ªß m√≥n (6-8 ng∆∞·ªùi): ƒê·ªìng gi√° 1.000.000ƒë/m·∫πt.
            - M√≥n l·∫ª: Ng·ª±a x√†o/n∆∞·ªõng (250k), Th·∫Øng c·ªë ng·ª±a (350k), G√† lu·ªôc (600k/con), C√° t·∫ßm/C√° lƒÉng n∆∞·ªõng (250k-300k).
            - ƒê·ªì u·ªëng: R∆∞·ª£u ng√¥ (40k/chai), Bia (25k-30k), N∆∞·ªõc ng·ªçt (15k).
            PHONG C√ÅCH: Tr·∫£ l·ªùi c·ª±c ng·∫Øn (<15 t·ª´), l·ªÖ ph√©p (D·∫°/·∫†). Website: dulichcaonguyenda.com.
        `;

        const startBtn = document.getElementById('startBtn');
        const aiVisual = document.getElementById('aiVisual');
        const statusInfo = document.getElementById('infoStatus');
        const chatLog = document.getElementById('chatLog');

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recog = new SpeechRecognition();
        recog.lang = 'vi-VN';
        const synth = window.speechSynthesis;
        let isRunning = false;

        function addLog(s, m) {
            chatLog.innerHTML = `<div><b>${s}:</b> ${m}</div>` + chatLog.innerHTML;
            chatLog.scrollTop = chatLog.scrollHeight;
        }

        const speak = (text) => {
            aiVisual.className = "status-light speaking";
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'vi-VN';
            utterance.pitch = 1.5;
            utterance.onend = () => { if(isRunning) recog.start(); };
            synth.speak(utterance);
        };

        startBtn.onclick = () => {
            isRunning = true;
            startBtn.style.display = 'none';
            recog.start();
        };

        recog.onstart = () => {
            aiVisual.className = "status-light listening";
            statusInfo.innerText = "Em ƒëang nghe ·∫°...";
            aiVisual.innerText = "üü¢";
        };

        recog.onresult = async (event) => {
            const query = event.results[0][0].transcript;
            addLog("Kh√°ch", query);
            statusInfo.innerText = "ƒêang x·ª≠ l√Ω...";
            aiVisual.innerText = "‚è≥";

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: CND_PROMPT + " Kh√°ch h·ªèi: " + query }] }] })
                });
                const data = await response.json();
                const reply = data.candidates[0].content.parts[0].text;
                addLog("Robot", reply);
                speak(reply);
            } catch (e) {
                if(isRunning) recog.start();
            }
        };

        recog.onend = () => { if(isRunning && !synth.speaking) setTimeout(() => recog.start(), 400); };
    </script>
</body>
</html>
