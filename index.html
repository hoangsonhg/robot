<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robot CND Äá»“ng VÄƒn - Báº£n Final</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; background: #0f172a; color: #f8fafc; padding: 20px; margin: 0; }
        .container { max-width: 500px; margin: auto; padding: 20px; }
        .status-circle { width: 180px; height: 180px; border-radius: 50%; background: #1e293b; margin: 40px auto; display: flex; align-items: center; justify-content: center; border: 8px solid #334155; transition: 0.5s; font-size: 60px; }
        .listening { border-color: #22c55e; box-shadow: 0 0 40px #22c55e; animation: pulse 1.5s infinite; }
        .speaking { border-color: #3b82f6; box-shadow: 0 0 40px #3b82f6; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        #startBtn { padding: 20px 40px; border-radius: 50px; border: none; background: #e11d48; color: white; font-weight: bold; cursor: pointer; font-size: 20px; box-shadow: 0 4px 15px rgba(225, 29, 72, 0.4); }
        #log { margin-top: 30px; background: rgba(0,0,0,0.4); height: 150px; overflow-y: auto; border-radius: 15px; padding: 15px; text-align: left; font-size: 14px; border: 1px solid #1e293b; }
        .info-text { font-size: 14px; color: #94a3b8; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h2 style="color: #38bdf8; margin-bottom: 5px;">ğŸ¤– Lá»„ TÃ‚N CND Äá»’NG VÄ‚N</h2>
        <p class="info-text">Há»‡ thá»‘ng AI chuyÃªn nghiá»‡p cá»§a anh SÆ¡n</p>
        
        <div id="visual" class="status-circle">ğŸ™ï¸</div>
        
        <p id="statusInfo" style="font-weight: bold; height: 24px;">Äang chá» anh kÃ­ch hoáº¡t...</p>
        
        <button id="startBtn">Báº®T Äáº¦U TRá»°C QUáº¦Y</button>
        
        <div id="log"></div>
    </div>

    <script>
        // Cáº¤U HÃŒNH Há»† THá»NG
        const API_KEY = "AIzaSyCs8gITrFcSUHYe_6KeJnWrcQd0tBdMgwo";
        const MODEL = "gemini-3.0-flash-preview"; 
        
        // THÆ¯ VIá»†N Dá»® LIá»†U NHÃ€ HÃ€NG & Äá»’NG VÄ‚N
        const SYSTEM_DATA = `
            Báº¡n lÃ  lá»… tÃ¢n 18 tuá»•i táº¡i NhÃ  hÃ ng CND Äá»“ng VÄƒn (Chá»§ lÃ  anh SÆ¡n - PhÃ³ Chá»§ tá»‹ch Há»™i Du lá»‹ch, Äáº¡i biá»ƒu HÄND).
            Dá»® LIá»†U CND: Láº©u Ngá»±a (600k-1.2tr), Máº¹t Ä‘áº·c sáº£n (1tr), GÃ  Ä‘en (250k), RÆ°á»£u ngÃ´ (40k). NhÃ  hÃ ng lÃ  nhÃ  sÃ n truyá»n thá»‘ng trÃªn máº£nh Ä‘áº¥t 471,9m2.
            Dá»® LIá»†U Äá»’NG VÄ‚N: CÃ³ Giáº¿ng NÆ°á»›c Tháº§n, Hang Táº£ Lá»§ng, Hang MÃ¢y, CÃ¡ dáº§m xanh, BÃ² vÃ ng Äá»“ng VÄƒn. Lá»… há»™i hoa Tam giÃ¡c máº¡ch sáº¯p diá»…n ra.
            PHONG CÃCH: Tráº£ lá»i cá»±c ngáº¯n (<15 tá»«), nhÃ­ nháº£nh, lá»… phÃ©p (Dáº¡/áº ). Website: dulichcaonguyenda.com.
        `;

        const startBtn = document.getElementById('startBtn');
        const visual = document.getElementById('visual');
        const statusInfo = document.getElementById('statusInfo');
        const log = document.getElementById('log');

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recog = new SpeechRecognition();
        recog.lang = 'vi-VN';
        recog.continuous = false;

        const synth = window.speechSynthesis;
        let isRunning = false;

        function updateLog(s, m) {
            log.innerHTML = `<div><b>${s}:</b> ${m}</div>` + log.innerHTML;
        }

        const speak = (text) => {
            visual.className = "status-circle speaking";
            statusInfo.innerText = "Em Ä‘ang tráº£ lá»i khÃ¡ch...";
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'vi-VN';
            utterance.pitch = 1.5; // Giá»ng nhÃ­ nháº£nh
            utterance.onend = () => { if(isRunning) recog.start(); };
            synth.speak(utterance);
        };

        startBtn.onclick = () => {
            isRunning = true;
            startBtn.style.display = 'none';
            recog.start();
        };

        recog.onstart = () => {
            visual.className = "status-circle listening";
            statusInfo.innerText = "Em Ä‘ang láº¯ng nghe áº¡...";
            visual.innerText = "ğŸŸ¢";
        };

        recog.onresult = async (event) => {
            const query = event.results[0][0].transcript;
            updateLog("KhÃ¡ch", query);
            statusInfo.innerText = "Äang há»i bá»™ nÃ£o Gemini 3.0...";
            visual.innerText = "ğŸŸ¡";

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: SYSTEM_DATA + " KhÃ¡ch há»i: " + query }] }] })
                });
                const data = await response.json();
                const reply = data.candidates[0].content.parts[0].text;
                updateLog("Robot", reply);
                speak(reply);
            } catch (e) {
                console.error(e);
                recog.start();
            }
        };

        recog.onend = () => {
            if(isRunning && !synth.speaking) {
                setTimeout(() => recog.start(), 500);
            }
        };

        recog.onerror = () => { if(isRunning) setTimeout(() => recog.start(), 1000); };
    </script>
</body>
</html>
