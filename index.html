<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robot CND - Full Menu 2026</title>
    <style>
        body { font-family: sans-serif; text-align: center; background: #020617; color: #f8fafc; padding: 20px; }
        .robot-box { max-width: 500px; margin: auto; padding: 30px; background: #0f172a; border-radius: 30px; border: 2px solid #1e293b; box-shadow: 0 25px 60px rgba(0,0,0,0.6); }
        .status-light { width: 140px; height: 140px; border-radius: 50%; background: #1e293b; margin: 25px auto; display: flex; align-items: center; justify-content: center; border: 6px solid #334155; font-size: 55px; transition: 0.4s; }
        .listening { border-color: #10b981; box-shadow: 0 0 40px #10b981; }
        .speaking { border-color: #3b82f6; box-shadow: 0 0 40px #3b82f6; }
        #startBtn { padding: 20px 40px; border-radius: 50px; border: none; background: #e11d48; color: white; font-weight: bold; cursor: pointer; font-size: 18px; }
        #chatLog { margin-top: 25px; background: rgba(0,0,0,0.3); height: 180px; overflow-y: auto; border-radius: 15px; padding: 15px; text-align: left; font-size: 14px; border: 1px solid #1e293b; }
    </style>
</head>
<body>
    <div class="robot-box">
        <h2 style="color: #38bdf8;">NH√Ä H√ÄNG CND ƒê·ªíNG VƒÇN</h2>
        <div id="visual" class="status-light">ü§ñ</div>
        <p id="info">S·∫µn s√†ng ph·ª•c v·ª• anh S∆°n!</p>
        <button id="startBtn">K√çCH HO·∫†T ROBOT</button>
        <div id="chatLog"></div>
    </div>

    <script>
        const API_KEY = "AIzaSyCs8gITrFcSUHYe_6KeJnWrcQd0tBdMgwo";
        const MODEL = "gemini-1.5-flash"; // D√πng b·∫£n Flash ·ªïn ƒë·ªãnh nh·∫•t ƒë·ªÉ tr√°nh l·ªói k·∫øt n·ªëi

        const MENU_CND = `
        B·∫†N L√Ä L·ªÑ T√ÇN NH√Ä H√ÄNG CND ƒê·ªíNG VƒÇN. TR·∫¢ L·ªúI C·ª∞C NG·∫ÆN (<15 T·ª™), D·∫†/·∫†.
        TH·ª∞C ƒê∆†N CHI TI·∫æT:
        1. TH·ªäT NG·ª∞A/B√í/D√ä: Ng·ª±a/B√≤/D√™ n∆∞·ªõng/x√†o (250k), S√°ch b√≤ (180k), Th·∫Øng c·ªë ng·ª±a (350k), Th·∫Øng c·ªë b√≤ (150k), Th·∫Øng c·ªë d√™ (230k).
        2. G√Ä & L·ª¢N ƒêEN: G√† rang/n∆∞·ªõng/om n·∫•m/canh g·ª´ng (250k), G√† lu·ªôc c·∫£ con (600k). L·ª£n h·∫•p/n∆∞·ªõng (200k), L·ª£n rang (180k), D·∫° d√†y (150k), Tim c·∫≠t x√†o (220k).
        3. C√Å T·∫¶M/LƒÇNG: C√° t·∫ßm x√†o/n∆∞·ªõng/canh chua (300k), Nem c√° (200k). C√° lƒÉng x√†o/n∆∞·ªõng/canh chua (250k), Canh ƒë·∫ßu c√° (150k).
        4. L·∫®U (2-3/4-6/7-8 ng∆∞·ªùi): Ng·ª±a/D√™ (600k/1tr/1.2tr), B√≤/G√† ƒëen (500k/800k/1tr), C√° t·∫ßm/lƒÉng (600k/900k/1.2tr), Th·∫≠p c·∫©m (1tr).
        5. M·∫∏T ƒê·ª¶ M√ìN (6-8 ng∆∞·ªùi - 1 TRI·ªÜU): M·∫πt l·ª£n; M·∫πt D√™+B√≤+G√†; M·∫πt B√≤+G√†+C√°; M·∫πt L·ª£n+G√†+C√°; M·∫πt L·ª£n+B√≤+G√†; M·∫πt Ng·ª±a+G√†+C√°.
        6. KH√ÅC: C√° su·ªëi (150k), M√®n m√©n x√†o tr·ª©ng/Tr·ª©ng r√°n (50k), Khoai t√¢y (40k), Rau/Canh (40k), C∆°m (30k). R∆∞·ª£u ng√¥ (40k), Bia (25k-30k).`;

        const startBtn = document.getElementById('startBtn');
        const visual = document.getElementById('visual');
        const info = document.getElementById('info');
        const chatLog = document.getElementById('chatLog');

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recog = new SpeechRecognition();
        recog.lang = 'vi-VN';
        const synth = window.speechSynthesis;
        let isRunning = false;

        const speak = (text) => {
            visual.className = "status-light speaking";
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'vi-VN';
            utterance.pitch = 1.4;
            utterance.onend = () => { if(isRunning) recog.start(); };
            synth.speak(utterance);
        };

        startBtn.onclick = () => { isRunning = true; startBtn.style.display = 'none'; recog.start(); };

        recog.onstart = () => { visual.className = "status-light listening"; visual.innerText = "üé§"; info.innerText = "ƒêang nghe ·∫°..."; };
        
        recog.onresult = async (event) => {
            const query = event.results[0][0].transcript;
            chatLog.innerHTML = `<div><b>Kh√°ch:</b> ${query}</div>` + chatLog.innerHTML;
            visual.innerText = "‚è≥";

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: MENU_CND + " Kh√°ch h·ªèi: " + query }] }] })
                });
                const data = await response.json();
                const reply = data.candidates[0].content.parts[0].text;
                chatLog.innerHTML = `<div style="color:#38bdf8"><b>Robot:</b> ${reply}</div>` + chatLog.innerHTML;
                speak(reply);
            } catch (e) {
                info.innerText = "L·ªói k·∫øt n·ªëi, ƒëang th·ª≠ l·∫°i...";
                setTimeout(() => recog.start(), 2000);
            }
        };

        recog.onend = () => { if(isRunning && !synth.speaking) setTimeout(() => recog.start(), 500); };
    </script>
</body>
</html>
